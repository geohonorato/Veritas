<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
  <link rel="stylesheet" as="style" onload="this.rel='stylesheet'"
    href="https://fonts.googleapis.com/css2?display=swap&family=Inter:wght@400;500;700;900&family=Noto+Sans:wght@400;500;700;900" />
  <title>Veritas Desktop - Sistema de Ponto Eletr√¥nico com Biometria</title>
  <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <script src="chart.js"></script>
  <link rel="stylesheet" href="style.css" />
  <style>
    section.hidden {
      display: none !important;
    }
    /* Oculta conte√∫do sens√≠vel at√© verificar autentica√ß√£o */
    body {
      opacity: 0;
      transition: opacity 0.2s;
    }
    body.auth-verified {
      opacity: 1;
    }
  </style>
</head>

<body class="bg-zinc-950 text-zinc-100 antialiased selection:bg-indigo-500/30 overflow-hidden">
  <!-- Verifica√ß√£o de Autentica√ß√£o ANTES de renderizar -->
  <script>
    (function() {
      const user = sessionStorage.getItem('veritas_user');
      if (!user) {
        // Redireciona IMEDIATAMENTE antes de qualquer renderiza√ß√£o
        window.location.replace('/login.html');
        return;
      }
      // Autorizado: permite visualiza√ß√£o
      document.body.classList.add('auth-verified');
    })();
  </script>
  <div class="flex h-screen">
    <!-- Sidebar -->
    <aside class="flex flex-col w-72 bg-zinc-950/50 backdrop-blur-xl border-r border-white/5 p-6 z-20">
      <div class="flex flex-col items-center gap-3 mb-8">
        <img
          src="https://www2.cesupa.br/ConhecaCesupa/GuiadeMarcaCESUPA/imgMarca/Logo%20Cesupa%20Branco%20(com%20descritivo).png"
          alt="CESUPA" class="w-52 h-auto" />
      </div>
      <nav id="sidebar-nav" class="flex flex-col gap-2">
        <a href="#"
          class="nav-item flex items-center gap-3 px-3 py-2 rounded-xl active bg-indigo-500/10 text-indigo-400 ring-1 ring-inset ring-indigo-500/20">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 transition-colors" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M3 12l2-2m0 0l7-7 7 7m-9 2v6m0 0h4m-4 0a2 2 0 01-2-2v-4a2 2 0 012-2h4a2 2 0 012 2v4a2 2 0 01-2 2z" />
          </svg>
          <span class="text-sm font-medium leading-normal transition-colors">In√≠cio</span>
        </a>
        <a href="#"
          class="nav-item flex items-center gap-3 px-3 py-2 rounded-xl text-zinc-400 hover:text-zinc-100 hover:bg-white/5 transition-all">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 transition-colors" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M3 3v18h18M9 17v-6m4 6V7m4 10v-2" />
          </svg>
          <span class="text-sm font-medium leading-normal transition-colors">Atividade</span>
        </a>
        <a href="#"
          class="nav-item flex items-center gap-3 px-3 py-2 rounded-xl text-zinc-400 hover:text-zinc-100 hover:bg-white/5 transition-all">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 transition-colors" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
          </svg>
          <span class="text-sm font-medium leading-normal transition-colors">Usu√°rios</span>
        </a>
        <a href="#"
          class="nav-item flex items-center gap-3 px-3 py-2 rounded-xl text-zinc-400 hover:text-zinc-100 hover:bg-white/5 transition-all">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 transition-colors" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M11.25 3.75a.75.75 0 011.5 0v1.1a7.5 7.5 0 015.65 5.65h1.1a.75.75 0 010 1.5h-1.1a7.5 7.5 0 01-5.65 5.65v1.1a.75.75 0 01-1.5 0v-1.1a7.5 7.5 0 01-5.65-5.65h-1.1a.75.75 0 010-1.5h1.1a7.5 7.5 0 015.65-5.65v-1.1z" />
          </svg>
          <span class="text-sm font-medium leading-normal transition-colors">Configura√ß√µes</span>
        </a>
        <a href="#"
          class="nav-item flex items-center gap-3 px-3 py-2 rounded-xl text-zinc-400 hover:text-zinc-100 hover:bg-white/5 transition-all">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 transition-colors" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 18h.01M12 14a4 4 0 100-8 4 4 0 000 8zm0 0v2a2 2 0 002 2h-4a2 2 0 002-2z" />
          </svg>
          <span class="text-sm font-medium leading-normal transition-colors">Ajuda</span>
        </a>

      </nav>

      <!-- Logout Button -->
      <div class="mt-auto pt-6 border-t border-white/5">
        <button id="logout-btn"
          class="w-full flex items-center gap-3 px-3 py-2 rounded-xl text-red-400 hover:text-red-300 hover:bg-red-500/10 transition-all">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24"
            stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
          </svg>
          <span class="text-sm font-medium leading-normal">Sair</span>
        </button>
      </div>
    </aside>
    <!-- Main Content -->
    <main class="flex-1 flex flex-col bg-zinc-950 overflow-y-auto no-scrollbar relative">
      <!-- Ambient Background Glow -->
      <div
        class="fixed top-0 left-[300px] w-full h-[500px] bg-indigo-600/10 blur-[120px] pointer-events-none rounded-full -translate-y-1/2">
      </div>

      <!-- Dashboard Content -->
      <!-- Dashboard Content -->
      <section id="dashboard-section" class="p-8">

        <!-- AI Search Component (Unified Premium Design) -->
        <div id="ai-search-container" class="w-full mb-8 relative z-50">
          <!-- Main Search Box (Expands when results show) -->
          <div id="ai-search-box" class="ai-search-box">
            <!-- Input Area -->
            <div class="ai-search-input-wrapper">
              <svg xmlns="http://www.w3.org/2000/svg" class="ai-search-icon" fill="none" viewBox="0 0 24 24"
                stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
              </svg>
              <input type="text" id="dashboard-ai-input" class="ai-search-input" placeholder="Pergunte ao Veritas..."
                autocomplete="off">
              <span id="ai-loading-indicator" class="hidden">
                <svg class="animate-spin size-4 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none"
                  viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor"
                    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                  </path>
                </svg>
              </span>
            </div>

            <!-- Result Area (Hidden by default, shown inside the same box) -->
            <div id="ai-result-area" class="ai-result-area hidden">
              <div class="ai-result-divider"></div>
              <div class="ai-result-content-wrapper">
                <div class="ai-result-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" class="size-5" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round"
                      d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                  </svg>
                </div>
                <div class="ai-result-text">
                  <p class="ai-result-label">Veritas AI</p>
                  <div id="ai-result-content" class="ai-result-body"></div>
                </div>
                <button id="close-ai-result" class="ai-result-close">
                  <svg xmlns="http://www.w3.org/2000/svg" class="size-4" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd"
                      d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                      clip-rule="evenodd" />
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>



        <!-- Cards -->
        <div class="flex flex-wrap gap-6 mb-8 items-start relative z-20">
          
          <!-- Presen√ßa Hoje Slot -->
          <div class="flex-1 min-w-[200px] relative"> 
             <!-- Invisible Spacer -->
             <div class="p-6 border border-transparent invisible">
                <p class="text-sm mb-1">Presen√ßa hoje</p>
                <div class="flex items-end justify-between"><p class="text-3xl font-bold">125</p></div>
             </div>
             
             <!-- Actual Floating Card -->
             <div 
                class="dashboard-card absolute top-0 left-0 w-full bg-zinc-900 border border-white/5 rounded-2xl overflow-hidden hover:border-indigo-500/30 hover:shadow-lg hover:shadow-indigo-500/10 transition-all duration-300 cursor-pointer z-10"
                data-target="presentes">
                <!-- Header -->
                <div class="p-6">
                    <p class="text-zinc-400 text-sm font-medium mb-1">Presen√ßa hoje</p>
                    <div class="flex items-end justify-between">
                        <p class="text-zinc-100 text-3xl font-bold group-hover:text-indigo-400 transition-colors" id="presenca-hoje">125</p>
                        <svg class="w-5 h-5 text-zinc-500 group-hover:text-indigo-400 transition-transform duration-300 transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </div>
                </div>
                <!-- List -->
                <div id="list-presentes" class="max-h-0 transition-all duration-500 ease-in-out opacity-0 bg-zinc-900">
                    <div class="p-2 border-t border-white/5 bg-black/20">
                       <div class="max-h-[300px] overflow-y-auto p-1 space-y-1 no-scrollbar"></div>
                    </div>
                </div>
             </div>
          </div>

          <!-- Ausentes Hoje Slot -->
          <div class="flex-1 min-w-[200px] relative">
             <div class="p-6 border border-transparent invisible">
                <p class="text-sm mb-1">Ausentes hoje</p>
                <div class="flex items-end justify-between"><p class="text-3xl font-bold">15</p></div>
             </div>
             
             <div 
                class="dashboard-card absolute top-0 left-0 w-full bg-zinc-900 border border-white/5 rounded-2xl overflow-hidden hover:border-purple-500/30 hover:shadow-lg hover:shadow-purple-500/10 transition-all duration-300 cursor-pointer z-10"
                data-target="ausentes">
                <div class="p-6">
                    <p class="text-zinc-400 text-sm font-medium mb-1">Ausentes hoje</p>
                    <div class="flex items-end justify-between">
                        <p class="text-zinc-100 text-3xl font-bold group-hover:text-purple-400 transition-colors" id="ausentes-hoje">15</p>
                        <svg class="w-5 h-5 text-zinc-500 group-hover:text-purple-400 transition-transform duration-300 transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </div>
                </div>
                <div id="list-ausentes" class="max-h-0 transition-all duration-500 ease-in-out opacity-0 bg-zinc-900">
                    <div class="p-2 border-t border-white/5 bg-black/20">
                       <div class="max-h-[300px] overflow-y-auto p-1 space-y-1 no-scrollbar"></div>
                    </div>
                </div>
             </div>
          </div>

          <!-- Total de Alunos Slot -->
          <div class="flex-1 min-w-[200px] relative">
             <div class="p-6 border border-transparent invisible">
                <p class="text-sm mb-1">Total de alunos</p>
                <div class="flex items-end justify-between"><p class="text-3xl font-bold">140</p></div>
             </div>
             
             <div 
                class="dashboard-card absolute top-0 left-0 w-full bg-zinc-900 border border-white/5 rounded-2xl overflow-hidden hover:border-emerald-500/30 hover:shadow-lg hover:shadow-emerald-500/10 transition-all duration-300 cursor-pointer z-10"
                data-target="todos">
                <div class="p-6">
                    <p class="text-zinc-400 text-sm font-medium mb-1">Total de alunos</p>
                    <div class="flex items-end justify-between">
                        <p class="text-zinc-100 text-3xl font-bold group-hover:text-emerald-400 transition-colors" id="total-alunos">140</p>
                        <svg class="w-5 h-5 text-zinc-500 group-hover:text-emerald-400 transition-transform duration-300 transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </div>
                </div>
                <div id="list-todos" class="max-h-0 transition-all duration-500 ease-in-out opacity-0 bg-zinc-900">
                    <div class="p-2 border-t border-white/5 bg-black/20">
                       <div class="max-h-[300px] overflow-y-auto p-1 space-y-1 no-scrollbar"></div>
                    </div>
                </div>
             </div>
          </div>


        </div>

        <!-- Charts Section -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
          <!-- Weekly Trend (Line Chart) -->
          <div class="lg:col-span-2 bg-zinc-900 border border-white/5 rounded-2xl p-6 shadow-lg shadow-black/20">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-zinc-400 text-sm font-medium">Tend√™ncia Semanal</h3>
              <div class="flex items-center gap-2">
                <span class="size-2 rounded-full bg-indigo-500"></span>
                <span class="text-xs text-zinc-500">Presen√ßas</span>
              </div>
            </div>
            <div class="relative h-64 w-full">
              <canvas id="chart-weekly"></canvas>
            </div>
          </div>

          <!-- Daily Overview (Doughnut) -->
          <div class="bg-zinc-900 border border-white/5 rounded-2xl p-6 shadow-lg shadow-black/20 flex flex-col">
            <h3 class="text-zinc-400 text-sm font-medium mb-4">Vis√£o Geral Hoje</h3>
            <div class="relative flex-1 min-h-[200px] flex items-center justify-center">
              <canvas id="chart-daily"></canvas>
              <!-- Center Text Overlay -->
              <div class="absolute inset-0 flex items-center justify-center flex-col pointer-events-none">
                <span id="chart-total-text" class="text-3xl font-bold text-white">0%</span>
                <span class="text-[10px] text-zinc-500 uppercase tracking-wider">Presen√ßa</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Calendar Section -->






        <!-- Tabela din√¢mica de alunos -->
        <!-- REMOVER a tabela daqui -->
      </section>
      <!-- Nova Se√ß√£o: Resumo Di√°rio (Presentes/Ausentes) -->
      <section id="daily-summary-section" class="p-8 hidden">
        <div class="flex flex-wrap justify-between items-center gap-3 p-4">
          <p id="daily-summary-title" class="text-white tracking-light text-[32px] font-bold leading-tight min-w-72">
            Resumo Di√°rio</p>
        </div>
        <div class="px-4 py-3">
          <table
            class="min-w-full bg-zinc-900 rounded-xl overflow-hidden border border-white/5 shadow-2xl shadow-black/20">
            <thead>
              <tr class="bg-zinc-950/50 border-b border-white/5">
                <th class="px-4 py-3 text-left text-zinc-400 text-sm font-semibold">Nome</th>
                <th class="px-4 py-3 text-left text-zinc-400 text-sm font-semibold">Matr√≠cula</th>
                <th class="px-4 py-3 text-left text-zinc-400 text-sm font-semibold">Turma</th>
                <th class="px-4 py-3 text-left text-zinc-400 text-sm font-semibold">Email</th>
                <th class="px-4 py-3 text-left text-zinc-400 text-sm font-semibold w-32">Dias da Semana</th>
              </tr>
            </thead>
            <tbody id="daily-summary-tbody">
              <!-- Alunos presentes/ausentes ser√£o inseridos aqui dinamicamente -->
            </tbody>
          </table>
        </div>
      </section>
      <!-- Se√ß√£o de Atividades -->
      <section id="atividades-section" class="p-8 hidden">
        <!-- Header Row: Title e A√ß√µes Principais -->
        <!-- Header Row: Title e A√ß√µes Principais -->
        <div class="flex flex-col xl:flex-row justify-between items-start xl:items-center gap-6 mb-8">
          <div class="flex flex-col gap-2">
            <h1 class="text-zinc-100 text-3xl font-bold tracking-tight">Atividades</h1>
            <p class="text-zinc-400 text-sm">Gerencie e visualize os registros de entrada e sa√≠da em tempo real.</p>
          </div>

          <div class="flex flex-wrap gap-3">

            <button id="export-activities-btn"
              class="group flex items-center gap-2 px-4 py-2.5 rounded-xl bg-zinc-900 text-zinc-400 hover:text-indigo-400 hover:bg-zinc-800 transition-all border border-white/5 hover:border-indigo-500/30 shadow-sm hover:shadow-indigo-500/10">
              <svg xmlns="http://www.w3.org/2000/svg" class="size-5 transition-transform group-hover:scale-110"
                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
              </svg>
              <span class="font-medium">Exportar Relat√≥rio</span>
            </button>
            <button id="manual-frequency-btn"
              class="group flex items-center gap-2 px-5 py-2.5 rounded-xl bg-indigo-600 text-white hover:bg-indigo-500 shadow-lg shadow-indigo-600/20 transition-all hover:shadow-indigo-600/40 ring-1 ring-white/10">
              <svg xmlns="http://www.w3.org/2000/svg" class="size-5 transition-transform group-hover:scale-110"
                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
              <span class="font-semibold">Nova Frequ√™ncia</span>
            </button>
          </div>
        </div>

        <!-- Filter Bar -->
        <div
          class="bg-zinc-900/80 backdrop-blur-sm border border-white/5 rounded-2xl p-2 mb-8 flex flex-col md:flex-row gap-2 shadow-lg shadow-black/20">
          <!-- Search Input -->
          <div class="relative flex-1 group">
            <div class="absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none">
              <svg xmlns="http://www.w3.org/2000/svg"
                class="size-5 text-zinc-500 group-focus-within:text-indigo-400 transition-colors" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
              </svg>
            </div>
            <input type="text" id="filter-nome"
              class="block w-full h-11 pl-10 pr-4 rounded-xl bg-zinc-950/50 border border-white/5 text-zinc-100 placeholder-zinc-600 focus:bg-zinc-900 focus:border-indigo-500/50 focus:ring-2 focus:ring-indigo-500/20 transition-all outline-none"
              placeholder="Buscar aluno por nome..." />
          </div>

          <!-- Separator (Desktop) -->
          <div class="hidden md:block w-px bg-white/10 my-2 mx-1"></div>

          <!-- Filters Group -->
          <div class="flex flex-wrap md:flex-nowrap gap-2 items-center">
            <select id="filter-turma"
              class="h-11 pl-4 pr-10 rounded-xl bg-zinc-950/50 border border-white/5 text-zinc-300 text-sm focus:bg-zinc-900 focus:border-indigo-500/50 focus:ring-2 focus:ring-indigo-500/20 transition-all outline-none cursor-pointer min-w-[140px]">
              <option value="">Todas as Turmas</option>
            </select>

            <select id="filter-turno"
              class="h-11 pl-4 pr-10 rounded-xl bg-zinc-950/50 border border-white/5 text-zinc-300 text-sm focus:bg-zinc-900 focus:border-indigo-500/50 focus:ring-2 focus:ring-indigo-500/20 transition-all outline-none cursor-pointer min-w-[140px]">
              <option value="">Todos os Turnos</option>
              <option value="Matutino">Matutino</option>
              <option value="Vespertino">Vespertino</option>
            </select>

            <!-- Month/Year Group -->
            <!-- Month Filter -->
            <select id="filter-mes-select"
              class="h-11 pl-4 pr-10 rounded-xl bg-zinc-950/50 border border-white/5 text-zinc-300 text-sm focus:bg-zinc-900 focus:border-indigo-500/50 focus:ring-2 focus:ring-indigo-500/20 transition-all outline-none cursor-pointer min-w-[140px]">
              <option value="">M√™s</option>
              <option value="01">Janeiro</option>
              <option value="02">Fevereiro</option>
              <option value="03">Mar√ßo</option>
              <option value="04">Abril</option>
              <option value="05">Maio</option>
              <option value="06">Junho</option>
              <option value="07">Julho</option>
              <option value="08">Agosto</option>
              <option value="09">Setembro</option>
              <option value="10">Outubro</option>
              <option value="11">Novembro</option>
              <option value="12">Dezembro</option>
            </select>

            <!-- Year Input -->
            <div class="relative">
              <input type="number" id="filter-ano-input"
                class="block w-24 h-11 px-4 rounded-xl bg-zinc-950/50 border border-white/5 text-zinc-100 placeholder-zinc-600 focus:bg-zinc-900 focus:border-indigo-500/50 focus:ring-2 focus:ring-indigo-500/20 transition-all outline-none text-center appearance-none"
                placeholder="Ano" />
              <style>
                #filter-ano-input::-webkit-outer-spin-button,
                #filter-ano-input::-webkit-inner-spin-button {
                  -webkit-appearance: none;
                  margin: 0;
                }

                #filter-ano-input {
                  -moz-appearance: textfield;
                  appearance: textfield;
                  -webkit-appearance: textfield;
                }
              </style>
            </div>

            <button id="clear-filters-btn"
              class="h-11 px-4 rounded-xl bg-zinc-950/50 text-zinc-500 hover:text-red-400 hover:bg-red-500/10 border border-white/5 hover:border-red-500/30 transition-all flex items-center justify-center"
              title="Limpar Filtros">
              <svg xmlns="http://www.w3.org/2000/svg" class="size-5" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 6h18"></path>
                <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
              </svg>
            </button>

            <button id="toggle-faltas-btn"
              class="h-11 px-4 rounded-xl bg-zinc-950/50 text-zinc-400 hover:text-amber-400 hover:bg-amber-500/10 border border-white/5 hover:border-amber-500/30 transition-all flex items-center gap-2 font-medium"
              title="Alternar para Faltas">
              <svg xmlns="http://www.w3.org/2000/svg" class="size-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 9v2m0 4v2m7.2-14H4.8c-1.12 0-2 .88-2 1.96V18c0 1.08.88 1.96 2 1.96h14.4c1.12 0 2-.88 2-1.96V2.96c0-1.08-.88-1.96-2-1.96z"></path>
              </svg>
              <span>Faltas</span>
            </button>

          </div>
        </div>

        <!-- Aba de Atividades -->
        <div id="atividades-tab" class="block">
          <div class="rounded-xl overflow-hidden border border-white/5 shadow-2xl shadow-black/20">
            <table class="min-w-full bg-zinc-900">
              <thead>
                <tr class="bg-zinc-950/50 border-b border-white/5">
                  <th class="px-6 py-4 text-left text-zinc-400 text-sm font-semibold">Aluno</th>
                  <th class="px-6 py-4 text-left text-zinc-400 text-sm font-semibold">Turma</th>
                  <th class="px-6 py-4 text-left text-zinc-400 text-sm font-semibold">Entrada</th>
                  <th class="px-6 py-4 text-left text-zinc-400 text-sm font-semibold">Sa√≠da</th>
                </tr>
              </thead>
              <tbody id="atividades-tbody">
                <!-- Linhas de atividades ser√£o inseridas aqui dinamicamente -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- Aba de Faltas -->
        <div id="faltas-tab" class="hidden">
          <div class="rounded-xl overflow-hidden border border-white/5 shadow-2xl shadow-black/20">
            <table class="min-w-full bg-zinc-900">
              <thead>
                <tr class="bg-zinc-950/50 border-b border-white/5">
                  <th class="px-6 py-4 text-left text-zinc-400 text-sm font-semibold">Aluno</th>
                  <th class="px-6 py-4 text-left text-zinc-400 text-sm font-semibold">Turma</th>
                  <th class="px-6 py-4 text-left text-zinc-400 text-sm font-semibold">Status</th>
                  <th class="px-6 py-4 text-center text-zinc-400 text-sm font-semibold">Observa√ß√£o</th>
                </tr>
              </thead>
              <tbody id="faltas-tbody">
                <!-- Linhas de faltas ser√£o inseridas aqui dinamicamente -->
              </tbody>
            </table>
          </div>
        </div>

      </section>
      <!-- Se√ß√£o de Ajuda -->
      <!-- Se√ß√£o de Ajuda -->
      <section id="ajuda-section" class="p-8 hidden">
        <h2 class="text-3xl font-bold tracking-tight text-zinc-100 mb-8">üìö Guia do Veritas - Sistema de Controle de Presen√ßa</h2>

        <div class="space-y-12">
          <!-- Vis√£o Geral -->
          <div class="bg-zinc-900/50 border border-white/5 rounded-xl p-6">
            <h3 class="text-2xl font-bold text-zinc-100 mb-4">üéØ O que √© o Veritas?</h3>
            <p class="text-zinc-300 leading-relaxed mb-4">
              O <strong>Veritas</strong> √© um sistema de gest√£o de presen√ßa e controle de acesso baseado em biometria (leitor de impress√µes digitais). 
              Ele registra automaticamente quando alunos chegam (Entrada) e saem (Sa√≠da), mantendo um hist√≥rico completo para relat√≥rios e an√°lise de frequ√™ncia.
            </p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
              <div class="bg-zinc-800/50 p-4 rounded-lg border border-indigo-500/20">
                <div class="text-indigo-400 font-bold mb-2">üìä Dashboard</div>
                <p class="text-sm text-zinc-400">Vis√£o geral com estat√≠sticas de presen√ßa do dia</p>
              </div>
              <div class="bg-zinc-800/50 p-4 rounded-lg border border-indigo-500/20">
                <div class="text-indigo-400 font-bold mb-2">üìã Atividades</div>
                <p class="text-sm text-zinc-400">Hist√≥rico completo de entradas e sa√≠das</p>
              </div>
              <div class="bg-zinc-800/50 p-4 rounded-lg border border-indigo-500/20">
                <div class="text-indigo-400 font-bold mb-2">‚õî Faltas</div>
                <p class="text-sm text-zinc-400">Alunos que n√£o compareceram (frequ√™ncia invertida)</p>
              </div>
            </div>
          </div>

          <!-- Como Usar -->
          <div>
            <h3 class="text-2xl font-bold text-zinc-100 mb-6">üöÄ Como Usar</h3>
            <div class="space-y-6">
              <!-- Dashboard -->
              <div class="border border-white/5 rounded-xl p-6 hover:border-indigo-500/30 transition-colors">
                <h4 class="text-lg font-bold text-indigo-400 mb-3">1Ô∏è‚É£ Dashboard (In√≠cio)</h4>
                <p class="text-zinc-300 mb-3">Sua tela inicial com informa√ß√µes em tempo real:</p>
                <ul class="list-disc list-inside text-zinc-400 space-y-2 ml-2">
                  <li><strong>Vis√£o Geral Hoje:</strong> Mostra quantos alunos est√£o presentes, ausentes e o total esperado</li>
                  <li><strong>Atividades Recentes:</strong> Feed das √∫ltimas entradas e sa√≠das registradas</li>
                  <li><strong>Calend√°rio:</strong> Clique em qualquer data para ver atividades daquele dia</li>
                  <li><strong>Gr√°ficos:</strong> Visualiza√ß√£o semanal e mensal de presen√ßa</li>
                </ul>
              </div>

              <!-- Atividades -->
              <div class="border border-white/5 rounded-xl p-6 hover:border-indigo-500/30 transition-colors">
                <h4 class="text-lg font-bold text-indigo-400 mb-3">2Ô∏è‚É£ Atividades</h4>
                <p class="text-zinc-300 mb-3">Tabela completa de todos os registros de presen√ßa:</p>
                <ul class="list-disc list-inside text-zinc-400 space-y-2 ml-2">
                  <li><strong>Coluna "Entrada":</strong> Hor√°rio que o aluno entrou no campus</li>
                  <li><strong>Coluna "Sa√≠da":</strong> Hor√°rio que o aluno saiu</li>
                  <li><strong>Filtros:</strong> Busque por aluno, turma, turno ou data espec√≠fica</li>
                  <li><strong>Exportar Relat√≥rio:</strong> Baixe os dados em arquivo para an√°lise</li>
                </ul>
              </div>

              <!-- Faltas -->
              <div class="border border-white/5 rounded-xl p-6 hover:border-indigo-500/30 transition-colors">
                <h4 class="text-lg font-bold text-indigo-400 mb-3">3Ô∏è‚É£ Faltas</h4>
                <p class="text-zinc-300 mb-3">Visualize rapidamente quem ainda n√£o compareceu:</p>
                <ul class="list-disc list-inside text-zinc-400 space-y-2 ml-2">
                  <li>Clique no bot√£o <span class="bg-amber-500/20 text-amber-400 px-2 py-1 rounded text-xs">üìã Faltas</span> para alternar para a aba</li>
                  <li><strong>Status "Faltante":</strong> Aluno ainda n√£o bateu ponto (durante o turno)</li>
                  <li><strong>Status "Falta Confirmada":</strong> Turno passou e aluno n√£o compareceu</li>
                  <li>Faltantes s√£o calculados automaticamente com base nos dias de aula de cada aluno</li>
                </ul>
              </div>

              <!-- Nova Frequ√™ncia -->
              <div class="border border-white/5 rounded-xl p-6 hover:border-indigo-500/30 transition-colors">
                <h4 class="text-lg font-bold text-indigo-400 mb-3">4Ô∏è‚É£ Nova Frequ√™ncia (Registro Manual)</h4>
                <p class="text-zinc-300 mb-3">Para alunos que tiveram problema com o leitor de digitais:</p>
                <ul class="list-disc list-inside text-zinc-400 space-y-2 ml-2">
                  <li>Clique em <span class="bg-indigo-600 text-white px-2 py-1 rounded text-xs">+ Nova Frequ√™ncia</span></li>
                  <li>Busque o aluno pelo nome ou matr√≠cula</li>
                  <li>Selecione a data e hora (padr√£o √© agora)</li>
                  <li>Escolha se √© "Entrada" ou "Sa√≠da"</li>
                  <li>Clique em "Salvar" para registrar</li>
                </ul>
              </div>

              <!-- Usu√°rios -->
              <div class="border border-white/5 rounded-xl p-6 hover:border-indigo-500/30 transition-colors">
                <h4 class="text-lg font-bold text-indigo-400 mb-3">5Ô∏è‚É£ Usu√°rios</h4>
                <p class="text-zinc-300 mb-3">Gerenciar a lista de alunos cadastrados:</p>
                <ul class="list-disc list-inside text-zinc-400 space-y-2 ml-2">
                  <li><strong>Visualizar:</strong> Veja todos os alunos, suas turmas, turnos e dias de aula</li>
                  <li><strong>Buscar:</strong> Use o campo de busca para encontrar alunos rapidamente</li>
                  <li><strong>Editar:</strong> Clique em um aluno para modificar suas informa√ß√µes</li>
                  <li><strong>Atualizar diasSemana:</strong> Defina em quais dias cada aluno tem aula</li>
                </ul>
              </div>

              <!-- Assistente IA -->
              <div class="border border-white/5 rounded-xl p-6 hover:border-indigo-500/30 transition-colors">
                <h4 class="text-lg font-bold text-indigo-400 mb-3">6Ô∏è‚É£ Assistente Inteligente (Chat IA)</h4>
                <p class="text-zinc-300 mb-3">Fa√ßa perguntas em linguagem natural sobre o sistema:</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-4">
                  <div class="bg-zinc-800/50 p-3 rounded border border-white/10">
                    <div class="font-medium text-indigo-400 text-sm mb-2">Exemplos de Perguntas:</div>
                    <ul class="text-xs text-zinc-400 space-y-1">
                      <li>‚úì "Quem faltou hoje?"</li>
                      <li>‚úì "Quantas faltas o Jo√£o tem?"</li>
                      <li>‚úì "Quem est√° presente agora?"</li>
                      <li>‚úì "Lista de alunos da turma DI5NA"</li>
                    </ul>
                  </div>
                  <div class="bg-zinc-800/50 p-3 rounded border border-white/10">
                    <div class="font-medium text-indigo-400 text-sm mb-2">Recursos:</div>
                    <ul class="text-xs text-zinc-400 space-y-1">
                      <li>‚úì Funciona offline (sem internet)</li>
                      <li>‚úì Responde em portugu√™s</li>
                      <li>‚úì Entende contexto da conversa</li>
                      <li>‚úì Clique no bot√£o azul para abrir</li>
                    </ul>
                  </div>
                </div>
              </div>

              <!-- Configura√ß√µes -->
              <div class="border border-white/5 rounded-xl p-6 hover:border-indigo-500/30 transition-colors">
                <h4 class="text-lg font-bold text-indigo-400 mb-3">‚öôÔ∏è Configura√ß√µes</h4>
                <ul class="list-disc list-inside text-zinc-400 space-y-2 ml-2">
                  <li><strong>Porta Serial:</strong> Configure a porta para comunica√ß√£o com o leitor biom√©trico</li>
                  <li><strong>Email:</strong> Configure notifica√ß√µes por email (faltas recorrentes, alertas)</li>
                  <li><strong>Status da Conex√£o:</strong> Verifique se o hardware est√° conectado corretamente</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Turmas e Turnos -->
          <div class="bg-zinc-900/50 border border-white/5 rounded-xl p-6">
            <h3 class="text-2xl font-bold text-zinc-100 mb-4">üè´ Turnos e Hor√°rios</h3>
            <p class="text-zinc-300 mb-4">O sistema reconhece dois turnos para determinar o limite de presen√ßa:</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="bg-zinc-800/50 p-4 rounded-lg border border-amber-500/30">
                <div class="font-bold text-amber-400 mb-2">‚òÄÔ∏è MATUTINO</div>
                <p class="text-sm text-zinc-400">Hor√°rio limite: <strong>12:00 (meio-dia)</strong></p>
                <p class="text-xs text-zinc-500 mt-2">Faltas ap√≥s 12h s√£o marcadas como "Falta Confirmada"</p>
              </div>
              <div class="bg-zinc-800/50 p-4 rounded-lg border border-orange-500/30">
                <div class="font-bold text-orange-400 mb-2">üåÖ VESPERTINO</div>
                <p class="text-sm text-zinc-400">Hor√°rio limite: <strong>18:00 (6 da tarde)</strong></p>
                <p class="text-xs text-zinc-500 mt-2">Faltas ap√≥s 18h s√£o marcadas como "Falta Confirmada"</p>
              </div>
            </div>
          </div>

          <!-- Dicas -->
          <div class="bg-green-900/20 border border-green-500/30 rounded-xl p-6">
            <h3 class="text-2xl font-bold text-green-400 mb-4">üí° Dicas √öteis</h3>
            <ul class="space-y-3">
              <li class="flex gap-3">
                <span class="text-green-400">‚úì</span>
                <span class="text-zinc-300"><strong>Faltas autom√°ticas:</strong> O sistema cria automaticamente a lista de faltantes no in√≠cio do dia, baseado no calend√°rio de aulas de cada aluno</span>
              </li>
              <li class="flex gap-3">
                <span class="text-green-400">‚úì</span>
                <span class="text-zinc-300"><strong>Atualiza√ß√£o em tempo real:</strong> Quando um aluno bate ponto, sua falta √© removida automaticamente da lista</span>
              </li>
              <li class="flex gap-3">
                <span class="text-green-400">‚úì</span>
                <span class="text-zinc-300"><strong>Registro manual:</strong> Use "Nova Frequ√™ncia" para casos de defeito no leitor ou problemas t√©cnicos</span>
              </li>
              <li class="flex gap-3">
                <span class="text-green-400">‚úì</span>
                <span class="text-zinc-300"><strong>Relat√≥rios:</strong> Exporte dados completos de atividades para an√°lises em Excel ou similares</span>
              </li>
              <li class="flex gap-3">
                <span class="text-green-400">‚úì</span>
                <span class="text-zinc-300"><strong>Chat IA:</strong> Use o assistente para respostas r√°pidas sobre presen√ßa sem sair do app</span>
              </li>
            </ul>
          </div>

          <!-- Solu√ß√£o de Problemas -->
          <div class="bg-red-900/20 border border-red-500/30 rounded-xl p-6">
            <h3 class="text-2xl font-bold text-red-400 mb-4">üîß Solu√ß√£o de Problemas</h3>
            <div class="space-y-4">
              <div>
                <h4 class="font-bold text-red-300 mb-2">‚ùì "Nenhuma falta registrada hoje"</h4>
                <p class="text-zinc-300 text-sm">
                  Isso significa que n√£o h√° alunos agendados para hoje OU todos os alunos esperados j√° bateram ponto. 
                  Verifique se o dia da semana est√° correto no calend√°rio de cada aluno (campo diasSemana).
                </p>
              </div>
              <div>
                <h4 class="font-bold text-red-300 mb-2">‚ùì "Status n√£o muda para Falta Confirmada"</h4>
                <p class="text-zinc-300 text-sm">
                  O status muda automaticamente quando o hor√°rio atual ultrapassar o limite do turno (12h para matutino, 18h para vespertino). 
                  Verifique se o rel√≥gio do servidor est√° sincronizado.
                </p>
              </div>
              <div>
                <h4 class="font-bold text-red-300 mb-2">‚ùì "N√£o consigo registrar frequ√™ncia manual"</h4>
                <p class="text-zinc-300 text-sm">
                  Certifique-se de que voc√™ selecionou um aluno v√°lido, escolheu uma data e clicou em "Salvar". 
                  Verifique o console do navegador (F12) para mensagens de erro.
                </p>
              </div>
            </div>
          </div>

          <!-- Informa√ß√µes T√©cnicas -->
          <div class="bg-zinc-900/50 border border-white/5 rounded-xl p-6">
            <h3 class="text-2xl font-bold text-zinc-100 mb-4">‚ö° Informa√ß√µes T√©cnicas</h3>
            <ul class="text-zinc-400 space-y-2 ml-4">
              <li><strong class="text-zinc-100">Tecnologia:</strong> Web App (Node.js + Express)</li>
              <li><strong class="text-zinc-100">Banco de Dados:</strong> SQLite</li>
              <li><strong class="text-zinc-100">Frontend:</strong> HTML5, TailwindCSS, JavaScript vanilla</li>
              <li><strong class="text-zinc-100">Comunica√ß√£o:</strong> REST API + WebSocket (Socket.io) para atualiza√ß√µes em tempo real</li>
              <li><strong class="text-zinc-100">IA:</strong> LangChain com modelo local (offline)</li>
              <li><strong class="text-zinc-100">Hardware:</strong> Leitor biom√©trico R307 conectado via porta serial ao ESP</li>
            </ul>
          </div>

          <!-- Rodap√© -->
          <!-- Rodap√© -->
          <div class="pt-8 border-t border-white/5 text-center">
            <p class="text-zinc-400 text-sm mb-2">
              <strong class="text-zinc-300">Veritas</strong> - Sistema Inteligente de Controle de Presen√ßa
            </p>
            <p class="text-zinc-500 text-xs">
              Desenvolvido por <strong class="text-zinc-400">Geovanni Honorato</strong>
            </p>
          </div>
        </div>
      </section>
      <!-- Se√ß√£o de Usu√°rios -->
      <section id="usuarios-section" class="p-8 hidden">
        <div class="flex flex-wrap justify-between items-center gap-3 p-4">
          <p class="text-zinc-100 tracking-light text-3xl font-bold leading-tight min-w-72">Usu√°rios</p>
          <div class="flex items-center gap-4 ml-auto">
            <button id="add-user-btn"
              class="flex items-center justify-center gap-2 rounded-xl bg-indigo-600 text-white hover:bg-indigo-500 transition-all px-4 h-10 shadow-lg shadow-indigo-600/20 hover:shadow-indigo-600/40">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
              </svg>
              <span class="font-semibold">Adicionar</span>
            </button>
            <div class="relative">
              <button id="user-menu-btn" title="Mais Op√ß√µes"
                class="flex items-center justify-center w-10 h-10 rounded-xl bg-zinc-900 border border-white/5 text-zinc-400 hover:text-white hover:bg-zinc-800 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24"
                  stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 5v.01M12 12v.01M12 19v.01" />
                </svg>
              </button>
              <div id="user-menu-dropdown"
                class="absolute right-0 mt-2 w-56 bg-zinc-900 border border-white/5 rounded-2xl shadow-xl shadow-black/50 hidden z-10 overflow-hidden">
                <a href="#" id="sync-users-menu-item"
                  class="flex items-center gap-2 px-4 py-3 text-zinc-300 hover:bg-white/5 hover:text-white transition-colors">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-indigo-400" fill="none"
                    viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h5M20 20v-5h-5M4 4l16 16" />
                  </svg>
                  <span>Sincronizar com Sensor</span>
                </a>
                <div class="border-t border-white/5 my-0"></div>
                <a href="#" id="remove-duplicates-menu-item"
                  class="flex items-center gap-2 px-4 py-3 text-yellow-400 hover:bg-white/5 hover:text-yellow-300 transition-colors">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
                  </svg>
                  <span>Remover Duplicados</span>
                </a>
                <a href="#" id="delete-users-menu-item"
                  class="flex items-center gap-2 px-4 py-3 text-red-400 hover:bg-red-500/10 hover:text-red-300 transition-colors">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round"
                      d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                  </svg>
                  <span>Excluir Usu√°rios...</span>
                </a>
              </div>
            </div>
          </div>
        </div>
        <div class="px-4 py-3">
          <label class="flex flex-col min-w-40 h-11 w-full relative group">
            <div class="absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none">
              <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px"
                class="text-zinc-500 group-focus-within:text-indigo-400 transition-colors" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                viewBox="0 0 24 24">
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
              </svg>
            </div>
            <input id="search-aluno" placeholder="Buscar por nome, matr√≠cula ou ID"
              class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl bg-zinc-950/50 border border-white/5 text-zinc-100 placeholder-zinc-600 focus:bg-zinc-900 focus:border-indigo-500/50 focus:ring-2 focus:ring-indigo-500/20 h-full pl-10 text-base font-normal leading-normal outline-none transition-all" />
          </label>
        </div>
        <div class="px-4 py-3">
          <table
            class="min-w-full bg-zinc-900 rounded-xl overflow-hidden border border-white/5 shadow-2xl shadow-black/20">
            <thead>
              <tr class="bg-zinc-950/50 border-b border-white/5">
                <th class="px-4 py-3 text-left w-10 delete-mode-col hidden"></th>
                <th class="px-4 py-3 text-center text-zinc-400 text-sm font-semibold border-r border-white/5">Nome</th>
                <th class="px-4 py-3 text-center text-zinc-400 text-sm font-semibold w-24 border-r border-white/5">
                  Matr√≠cula</th>
                <th class="px-4 py-3 text-center text-zinc-400 text-sm font-semibold w-24 border-r border-white/5">Turma
                </th>
                <th class="px-4 py-3 text-center text-zinc-400 text-sm font-semibold w-24 border-r border-white/5">Turno
                </th>
                <th class="px-4 py-3 text-center text-zinc-400 text-sm font-semibold w-48 border-r border-white/5">Email
                </th>
                <th class="px-4 py-3 text-center text-zinc-400 text-sm font-semibold w-24 border-r border-white/5">
                  Cabine
                </th>
                <th class="px-4 py-3 text-center text-zinc-400 text-sm font-semibold w-24 border-r border-white/5">
                  G√™nero
                </th>
                <th class="px-4 py-3 text-center text-zinc-400 text-sm font-semibold w-16 border-r border-white/5">ID
                </th>
                <th class="px-4 py-3 text-center text-zinc-400 text-sm font-semibold w-32 border-r border-white/5">Dias
                  da
                  Semana</th>
                <th class="px-4 py-3 text-center text-white text-sm font-medium w-12"></th>
              </tr>
            </thead>
            <tbody id="usuarios-tbody"></tbody>
          </table>
        </div>
      </section>
      <!-- Se√ß√£o de Configura√ß√µes (Redesign v2: Polido & Cores Suaves) -->
      <section id="settings-section" class="p-8 hidden max-w-5xl mx-auto w-full"> 

        <header class="mb-10 border-b border-white/5 pb-6">
          <h1 class="text-3xl font-bold text-zinc-100 tracking-tight">Configura√ß√µes</h1>
          <p class="text-zinc-500 text-sm mt-1">Gerencie as prefer√™ncias globais do sistema, hardware e integra√ß√µes.</p>
        </header>

        <div class="space-y-12">
            
            <!-- Grupo 1: Hardware -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="md:col-span-1">
                    <h3 class="text-lg font-medium text-zinc-100 flex items-center gap-2">
                        <span class="w-1.5 h-1.5 rounded-full bg-indigo-500"></span> Hardware
                    </h3>
                    <p class="text-sm text-zinc-500 mt-2 leading-relaxed">Configura√ß√£o da conex√£o com o leitor biom√©trico e feedback f√≠sico do dispositivo.</p>
                </div>
                <div class="md:col-span-2 space-y-6">
                    
                    <!-- Row: Serial Port -->
                    <div class="flex flex-col sm:flex-row items-center justify-between p-5 bg-zinc-900/50 rounded-xl border border-white/5 border-l-2 border-l-indigo-500/50">
                        <div class="flex-1 pr-6 mb-4 sm:mb-0 w-full sm:w-auto">
                             <div class="flex items-center gap-3 mb-1">
                                <span class="text-sm font-medium text-zinc-200">Porta Serial</span>
                                <div id="status-serial-indicator" class="flex items-center gap-1.5 px-2 py-0.5 rounded bg-zinc-950 border border-white/5">
                                    <span id="status-serial" class="size-1.5 rounded-full bg-red-500"></span>
                                    <span class="text-[10px] font-bold text-zinc-500 uppercase">OFF</span>
                                </div>
                             </div>
                             <p class="text-xs text-zinc-500">Selecione a porta onde o sensor est√° conectado.</p>
                        </div>
                        <div class="flex items-center gap-3 w-full sm:w-auto">
                            <select id="select-serial-port" class="bg-zinc-950 border border-white/10 rounded-lg px-3 py-2 text-sm text-zinc-300 focus:border-indigo-500/50 outline-none flex-1 sm:w-48 h-[42px]">
                                <option value="">Buscar portas...</option>
                            </select>
                            <button id="save-serial-settings" class="px-4 h-[42px] bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-sm font-semibold transition-colors flex items-center justify-center">
                                Conectar
                            </button>
                        </div>
                    </div>

                    <!-- Row: Buzzer & Sync -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                        <div class="flex items-start justify-between p-5 bg-zinc-900/50 rounded-xl border border-white/5">
                            <div>
                                <h4 class="text-sm font-medium text-zinc-200">Bip Sonoro</h4>
                                <p class="text-xs text-zinc-500 mt-1">Feedback de √°udio ao registrar.</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer mt-1">
                                <input type="checkbox" id="toggle-buzzer" class="sr-only peer">
                                <div class="w-9 h-5 bg-zinc-700 rounded-full peer peer-focus:ring-2 peer-focus:ring-indigo-800 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-indigo-600"></div>
                            </label>
                        </div>
                        <div class="flex items-start justify-between p-5 bg-zinc-900/50 rounded-xl border border-white/5">
                            <div>
                                <h4 class="text-sm font-medium text-zinc-200">Rel√≥gio do Sensor</h4>
                                <p class="text-xs text-zinc-500 mt-1">Sincronizar hora com PC.</p>
                            </div>
                            <button id="sync-time-btn" class="mt-0.5 p-2 bg-zinc-950 hover:bg-zinc-800 border border-white/10 rounded-lg text-zinc-400 hover:text-indigo-400 transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="size-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"></path><path d="M16 21h5v-5"></path></svg>
                            </button>
                        </div>
                    </div>

                </div>
            </div>

            <div class="w-full h-px bg-white/5"></div>

            <!-- Grupo 2: Intelig√™ncia Artificial -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="md:col-span-1">
                    <h3 class="text-lg font-medium text-zinc-100 flex items-center gap-2">
                         <span class="w-1.5 h-1.5 rounded-full bg-purple-500"></span> C√©rebro IA
                    </h3>
                    <p class="text-sm text-zinc-500 mt-2 leading-relaxed">Configure onde a IA busca documentos para aprender e responder perguntas.</p>
                </div>
                <div class="md:col-span-2 space-y-6">
                    
                     <div class="bg-zinc-900/50 rounded-xl border border-white/5 overflow-hidden border-l-2 border-l-purple-500/50">
                        <div class="px-5 py-4 border-b border-white/5 flex items-center justify-between bg-purple-500/[0.02]">
                            <span class="text-sm font-medium text-zinc-200">Base de Conhecimento RAG</span>
                            <span id="knowledge-status" class="text-[10px] uppercase font-bold text-zinc-500 bg-zinc-950 px-2 py-1 rounded border border-white/5">Idle</span>
                        </div>
                        <div class="p-5 grid gap-4">
                             <div>
                                 <label class="text-[11px] font-bold text-zinc-500 uppercase tracking-wider mb-2 block">Diret√≥rio Fonte</label>
                                 <div class="flex items-center gap-3">
                                    <div class="flex-1 relative">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="size-4 text-zinc-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>
                                        </div>
                                        <input type="text" id="knowledge-path-input" 
                                           class="w-full bg-zinc-950 border border-white/10 rounded-lg py-2.5 pl-10 pr-4 text-sm text-zinc-300 font-mono focus:border-purple-500/50 outline-none h-[42px]" 
                                           placeholder="caminho/para/docs">
                                    </div>
                                    <button id="knowledge-ingest-btn" class="px-4 h-[42px] bg-zinc-950 hover:bg-zinc-800 border border-white/10 hover:border-purple-500/30 text-zinc-300 hover:text-purple-400 font-medium rounded-lg transition-all flex items-center gap-2 text-sm">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="size-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /></svg>
                                        Processar
                                    </button>
                                 </div>
                             </div>
                             <p class="text-xs text-zinc-500">Suporta PDFs, DOCs e planilhas.</p>
                        </div>
                     </div>

                </div>
            </div>

            <div class="w-full h-px bg-white/5"></div>

            <!-- Grupo 3: Notifica√ß√µes -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="md:col-span-1">
                    <h3 class="text-lg font-medium text-zinc-100 flex items-center gap-2">
                         <span class="w-1.5 h-1.5 rounded-full bg-emerald-500"></span> Comunica√ß√£o
                    </h3>
                    <p class="text-sm text-zinc-500 mt-2 leading-relaxed">Configura√ß√µes de envio de e-mails para notifica√ß√µes de presen√ßa.</p>
                </div>
                <div class="md:col-span-2 space-y-6">
                    
                    <div class="bg-zinc-900/50 rounded-xl border border-white/5 p-5 border-l-2 border-l-emerald-500/50">
                         <!-- Fixed Layout for Mobile/Desktop -->
                         <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6">
                            <h4 class="text-sm font-medium text-zinc-200">M√©todo de Envio</h4>
                            <div class="relative w-full sm:w-64">
                                <select id="email-mode-select" class="w-full appearance-none bg-zinc-950 border border-white/10 rounded-lg py-2 pl-3 pr-8 text-xs text-zinc-300 font-medium focus:outline-none focus:border-emerald-500/50 hover:bg-zinc-900 cursor-pointer transition-colors h-[38px]">
                                    <option value="oauth2">Google OAuth (Recomendado)</option>
                                    <option value="smtp">SMTP Personalizado</option>
                                </select>
                                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-zinc-500">
                                    <svg class="size-3" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" /></svg>
                                </div>
                            </div>
                         </div>

                         <!-- OAuth Mode Content -->
                         <div id="oauth-fields" class="flex flex-col sm:flex-row items-center gap-4 bg-zinc-950/30 p-4 rounded-lg border border-white/5">
                             <div class="bg-white p-2 rounded-full shrink-0">
                                 <svg viewBox="0 0 24 24" class="size-5"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg>
                             </div>
                             <div class="flex-1 text-center sm:text-left">
                                 <p id="oauth-status" class="text-sm font-medium text-zinc-300">N√£o conectado</p>
                                 <p class="text-[11px] text-zinc-500">Conta Institucional</p>
                             </div>
                             <button id="connect-google-btn" class="text-xs font-bold text-indigo-400 hover:text-indigo-300 hover:bg-indigo-500/10 px-4 py-2 rounded transition-colors uppercase border border-indigo-500/20">
                                Conectar
                             </button>
                         </div>

                         <!-- SMTP Mode Content (Hidden) -->
                         <div id="smtp-fields" class="hidden space-y-3 mt-4">
                            <div class="grid grid-cols-2 gap-3">
                                <input id="smtp-host" placeholder="Host (smtp.gmail.com)" class="bg-zinc-950 border border-white/10 rounded-lg px-3 py-2 text-xs text-zinc-300">
                                <input id="smtp-port" placeholder="Porta (587)" class="bg-zinc-950 border border-white/10 rounded-lg px-3 py-2 text-xs text-zinc-300">
                            </div>
                            <input id="smtp-user" placeholder="Usu√°rio" class="w-full bg-zinc-950 border border-white/10 rounded-lg px-3 py-2 text-xs text-zinc-300">
                            <input id="smtp-pass" type="password" placeholder="Senha" class="w-full bg-zinc-950 border border-white/10 rounded-lg px-3 py-2 text-xs text-zinc-300">
                            <button id="save-settings-btn" class="w-full bg-zinc-800 hover:bg-zinc-700 text-white py-2 rounded-lg text-xs font-bold transition-colors">Salvar Credenciais</button>
                         </div>

                         <div class="flex items-center gap-4 mt-5 pt-5 border-t border-white/5">
                            <button id="test-email-btn" class="text-xs font-medium text-zinc-400 hover:text-zinc-100 transition-colors flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="size-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14l4-4V6zm-2 0l-8 5-8-5h16zm2 12H4V8l8 5 8-5v10z"></path></svg>
                                Enviar Email de Teste
                            </button>
                            <span id="email-test-status" class="text-[10px] text-emerald-400 font-medium"></span>
                         </div>
                    </div>

                </div>
            </div>

            <div class="w-full h-px bg-white/5"></div>

            <!-- Grupo 4: Dados -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="md:col-span-1">
                    <h3 class="text-lg font-medium text-zinc-100 flex items-center gap-2">
                        <span class="w-1.5 h-1.5 rounded-full bg-blue-500"></span> Dados
                    </h3>
                    <p class="text-sm text-zinc-500 mt-2 leading-relaxed">Gerencie onde os relat√≥rios de presen√ßa s√£o salvos e ferramentas de manuten√ß√£o.</p>
                </div>
                <div class="md:col-span-2 space-y-6">
                    <div class="p-5 bg-zinc-900/50 rounded-xl border border-white/5 border-l-2 border-l-blue-500/50">
                         <label class="text-[11px] font-bold text-zinc-500 uppercase tracking-wider mb-3 block">Caminho de Exporta√ß√£o</label>
                         <div class="flex items-center gap-3">
                            <input id="excel-path-display" readonly class="flex-1 bg-zinc-950 border border-white/10 rounded-lg px-4 py-2.5 text-sm text-zinc-400 font-mono outline-none h-[42px]" placeholder="C:/...">
                            <button id="select-excel-path-btn" class="px-4 h-[42px] bg-zinc-950 hover:bg-zinc-800 border border-white/10 text-zinc-300 rounded-lg text-sm font-medium transition-colors">Alterar</button>
                         </div>
                    </div>

                     <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <button id="settings-sync-users-btn" class="flex items-center justify-center gap-2 p-3 bg-zinc-900/50 hover:bg-zinc-800 border border-white/5 rounded-lg transition-colors group">
                            <svg xmlns="http://www.w3.org/2000/svg" class="size-4 text-zinc-500 group-hover:text-blue-400 transition-colors" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                            <span class="text-sm font-medium text-zinc-400 group-hover:text-zinc-200">Importar CSV</span>
                        </button>
                         <button id="settings-remove-duplicates-btn" class="flex items-center justify-center gap-2 p-3 bg-zinc-900/50 hover:bg-zinc-800 border border-white/5 rounded-lg transition-colors group">
                            <svg xmlns="http://www.w3.org/2000/svg" class="size-4 text-zinc-500 group-hover:text-emerald-400 transition-colors" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                            <span class="text-sm font-medium text-zinc-400 group-hover:text-zinc-200">Otimizar DB</span>
                        </button>
                    </div>
                </div>
            </div>

            <div class="w-full h-px bg-white/5"></div>

            <!-- Grupo 5: Danger Zone -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 pb-10">
                <div class="md:col-span-1">
                    <h3 class="text-lg font-medium text-red-400 flex items-center gap-2">
                        <span class="w-1.5 h-1.5 rounded-full bg-red-500"></span> Zona de Perigo
                    </h3>
                    <p class="text-sm text-zinc-500 mt-2 leading-relaxed">A√ß√µes destrutivas e irrevers√≠veis.</p>
                </div>
                <div class="md:col-span-2">
                    <div class="border border-red-500/10 bg-red-500/5 rounded-xl divide-y divide-red-500/10 border-l-2 border-l-red-500/50">
                        <div class="flex items-center justify-between p-4 border-b border-red-500/10">
                            <div>
                                <h4 class="text-sm font-medium text-red-200">Resetar Hist√≥rico</h4>
                                <p class="text-xs text-red-400/50">Apaga todos os registros de presen√ßa.</p>
                            </div>
                            <button id="clear-activities-btn" class="px-3 py-1.5 bg-red-500/10 hover:bg-red-500 hover:text-white text-red-400 text-xs font-bold rounded transition-all border border-red-500/20">
                                Resetar
                            </button>
                        </div>
                        <div class="flex items-center justify-between p-4">
                            <div>
                                <h4 class="text-sm font-medium text-red-200">Formatar Sensor</h4>
                                <p class="text-xs text-red-400/50">Apaga todas as digitais do dispositivo f√≠sico.</p>
                            </div>
                            <button id="empty-sensor-btn" class="px-3 py-1.5 bg-red-500/10 hover:bg-red-500 hover:text-white text-red-400 text-xs font-bold rounded transition-all border border-red-500/20">
                                Formatar
                            </button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
      </section>
      <!-- Modal/Cadastro de Aluno -->
      <div id="cadastro-aluno"
        class="fixed inset-0 z-50 flex items-center justify-center bg-zinc-950/80 backdrop-blur-sm hidden p-4">
        <div
          class="bg-zinc-900 border border-white/5 rounded-2xl shadow-2xl shadow-black/50 w-full max-w-xl p-6 md:p-8 relative max-h-[90vh] overflow-y-auto no-scrollbar">
          <button id="fechar-cadastro"
            class="absolute top-4 right-4 text-zinc-400 hover:text-white text-2xl transition-colors">&times;</button>
          <h2 id="modal-title" class="text-zinc-100 text-2xl font-bold mb-5 tracking-tight">Adicionar Aluno</h2>
          <form id="form-aluno" class="grid grid-cols-1 md:grid-cols-6 gap-x-4 gap-y-3">
            <input type="hidden" name="id" id="aluno-id" />
            <label class="flex flex-col md:col-span-6 relative group">
              <span class="text-zinc-400 text-sm font-medium pb-1.5">Nome completo</span>
              <input name="nome" required placeholder="Digite o nome completo"
                class="form-input rounded-xl bg-zinc-950/50 border border-white/5 text-zinc-100 h-9 px-4 text-sm placeholder:text-zinc-600 focus:bg-zinc-900 focus:border-indigo-500/50 focus:ring-2 focus:ring-indigo-500/20 outline-none transition-all" />
              <button type="button" id="search-by-name"
                class="absolute right-3 top-[30px] text-zinc-500 hover:text-indigo-400 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor"
                  viewBox="0 0 256 256">
                  <path
                    d="M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z">
                  </path>
                </svg>
              </button>
            </label>
            <label class="flex flex-col items-start md:col-span-2 relative">
              <span class="text-zinc-400 text-sm font-medium pb-1.5">Matr√≠cula</span>
              <input name="matricula" required placeholder="Digite a matr√≠cula"
                class="form-input w-full rounded-xl bg-zinc-950/50 border border-white/5 text-zinc-100 h-9 px-4 text-sm placeholder:text-zinc-600 focus:bg-zinc-900 focus:border-indigo-500/50 focus:ring-2 focus:ring-indigo-500/20 outline-none transition-all" />
              <button type="button" id="search-by-matricula"
                 class="absolute right-3 top-[30px] text-zinc-500 hover:text-indigo-400 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor"
                  viewBox="0 0 256 256">
                  <path
                    d="M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z">
                  </path>
                </svg>
              </button>
            </label>
            <label class="flex flex-col md:col-span-2">
              <span class="text-zinc-400 text-sm font-medium pb-1.5">Turma</span>
              <select name="turma" required id="modal-turma-select"
                class="w-full bg-zinc-950 border border-white/10 rounded-xl px-4 py-2.5 text-sm text-white focus:outline-none focus:border-indigo-500/50 transition-colors cursor-pointer">
                <option value="">Selecione a turma</option>
                <option value="ADM">ADM</option>
                <option value="DI7NA">DI7NA</option>
                <option value="DI8MA">DI8MA</option>
                <option value="DI8TA">DI8TA</option>
                <option value="DI8TB">DI8TB</option>
                <option value="DI8NA">DI8NA</option>
                <option value="DI9NA">DI9NA</option>
                <option value="DI0MA">DI0MA</option>
                <option value="DI0TA">DI0TA</option>
                <option value="DI0TB">DI0TB</option>
                <option value="DI0NA">DI0NA</option>
              </select>
            </label>
            <label class="flex flex-col md:col-span-2">
              <span class="text-zinc-400 text-sm font-medium pb-1.5">Turno</span>
              <select name="turno" required id="modal-turno-select"
                class="w-full bg-zinc-950 border border-white/10 rounded-xl px-4 py-2.5 text-sm text-white focus:outline-none focus:border-indigo-500/50 transition-colors cursor-pointer">
                <option value="">Selecione o turno</option>
                <option value="Matutino">Matutino</option>
                <option value="Vespertino">Vespertino</option>
              </select>
            </label>
            <label class="flex flex-col md:col-span-4">
              <span class="text-zinc-400 text-sm font-medium pb-1.5">Email</span>
              <input name="email" type="email" required placeholder="Digite o email"
                class="form-input rounded-xl bg-zinc-950/50 border border-white/5 text-zinc-100 h-9 px-4 text-sm placeholder:text-zinc-600 focus:bg-zinc-900 focus:border-indigo-500/50 focus:ring-2 focus:ring-indigo-500/20 outline-none transition-all" />
            </label>

            <label class="flex flex-col md:col-span-2">
              <span class="text-zinc-400 text-sm font-medium pb-1.5">Cabine</span>
              <input name="cabine" placeholder="N/A"
                class="form-input rounded-xl bg-zinc-950/50 border border-white/5 text-zinc-100 h-9 px-4 text-sm placeholder:text-zinc-600 focus:bg-zinc-900 focus:border-indigo-500/50 focus:ring-2 focus:ring-indigo-500/20 outline-none transition-all" />
            </label>

            <label class="flex flex-col md:col-span-2">
              <span class="text-zinc-400 text-sm font-medium pb-1.5">G√™nero</span>
              <select name="genero" required id="modal-genero-select"
                class="w-full bg-zinc-950 border border-white/10 rounded-xl px-4 py-2.5 text-sm text-white focus:outline-none focus:border-indigo-500/50 transition-colors cursor-pointer">
                <option value="">Selecione o g√™nero</option>
                <option value="Masculino">Masculino</option>
                <option value="Feminino">Feminino</option>
                <option value="Outro">Outro</option>
              </select>
            </label>

            <div class="flex flex-col md:col-span-6">
              <span class="text-zinc-400 text-sm font-medium pb-2">Dias da semana</span>
              <div class="grid grid-cols-7 gap-1 mt-0 h-9 items-center">
                <label
                  class="flex items-center justify-center cursor-pointer bg-zinc-950/50 border border-white/5 rounded-lg h-full hover:bg-zinc-800 transition-colors">
                  <input type="checkbox" name="dias-semana" value="1"
                    class="form-checkbox hidden" />
                  <span class="text-zinc-300 text-xs font-medium week-day-label">Seg</span>
                </label>
                <label
                  class="flex items-center justify-center cursor-pointer bg-zinc-950/50 border border-white/5 rounded-lg h-full hover:bg-zinc-800 transition-colors">
                  <input type="checkbox" name="dias-semana" value="2"
                    class="form-checkbox hidden" />
                  <span class="text-zinc-300 text-xs font-medium week-day-label">Ter</span>
                </label>
                <label
                  class="flex items-center justify-center cursor-pointer bg-zinc-950/50 border border-white/5 rounded-lg h-full hover:bg-zinc-800 transition-colors">
                  <input type="checkbox" name="dias-semana" value="3"
                    class="form-checkbox hidden" />
                  <span class="text-zinc-300 text-xs font-medium week-day-label">Qua</span>
                </label>
                <label
                  class="flex items-center justify-center cursor-pointer bg-zinc-950/50 border border-white/5 rounded-lg h-full hover:bg-zinc-800 transition-colors">
                  <input type="checkbox" name="dias-semana" value="4"
                    class="form-checkbox hidden" />
                  <span class="text-zinc-300 text-xs font-medium week-day-label">Qui</span>
                </label>
                <label
                  class="flex items-center justify-center cursor-pointer bg-zinc-950/50 border border-white/5 rounded-lg h-full hover:bg-zinc-800 transition-colors">
                  <input type="checkbox" name="dias-semana" value="5"
                    class="form-checkbox hidden" />
                  <span class="text-zinc-300 text-xs font-medium week-day-label">Sex</span>
                </label>
                <label
                  class="flex items-center justify-center cursor-pointer bg-zinc-950/50 border border-white/5 rounded-lg h-full hover:bg-zinc-800 transition-colors">
                  <input type="checkbox" name="dias-semana" value="6"
                    class="form-checkbox hidden" />
                  <span class="text-zinc-300 text-xs font-medium week-day-label">S√°b</span>
                </label>
                <label
                  class="flex items-center justify-center cursor-pointer bg-zinc-950/50 border border-white/5 rounded-lg h-full hover:bg-zinc-800 transition-colors">
                  <input type="checkbox" name="dias-semana" value="0"
                    class="form-checkbox hidden" />
                  <span class="text-zinc-300 text-xs font-medium week-day-label">Dom</span>
                </label>
              </div>
            </div>
            <style>
              .week-day-label { color: #52525b; }
              label:has(input[name="dias-semana"]:checked) .week-day-label { color: #818cf8; font-weight: bold; }
              label:has(input[name="dias-semana"]:checked) { background-color: rgba(99, 102, 241, 0.1); border-color: rgba(99, 102, 241, 0.2); }
            </style>
            <div class="md:col-span-6 border-t border-white/5 pt-4 mt-2">
                 <!-- Status Message integrated above buttons -->
                 <div id="status-biometria" class="text-zinc-400 text-xs text-center mb-3 min-h-[16px] transition-all"></div>
                 
                 <div class="flex justify-between items-center">
                    <button type="button" id="delete-user-modal-btn"
                        class="rounded-full bg-red-600/10 text-red-500 font-bold px-5 h-9 hidden border border-red-500/20 hover:bg-red-600 hover:text-white transition-all text-xs">Excluir</button>
                    
                    <div class="flex gap-3 ml-auto w-full md:w-auto justify-end">
                        <button type="button" id="fechar-cadastro-btn-secondary" 
                            class="rounded-full bg-zinc-950 text-zinc-400 font-medium px-5 h-9 border border-white/10 hover:bg-zinc-800 hover:text-white transition-all text-sm">Cancelar</button>
                        <button type="submit"
                            class="rounded-full bg-indigo-600 text-white font-bold px-6 h-9 shadow-lg shadow-indigo-600/20 hover:bg-indigo-500 hover:shadow-indigo-600/40 transition-all text-sm">Salvar</button>
                    </div>
                 </div>
            </div>
          </form>
          <!-- Old status div removed -->
        </div>
      </div>
    </main>
  </div>
  <script src="script.js"></script>



  <!-- Modal de Alerta/Confirma√ß√£o Customizado -->
  <div id="custom-alert-modal"
    class="fixed inset-0 z-50 flex items-center justify-center bg-zinc-950/80 backdrop-blur-sm hidden p-4">
    <div class="bg-zinc-900 border border-white/5 rounded-2xl shadow-2xl shadow-black/50 w-full max-w-sm p-6 relative">
      <h3 id="custom-alert-title" class="text-zinc-100 text-xl font-bold mb-4 tracking-tight"></h3>
      <p id="custom-alert-message" class="text-zinc-400 text-base mb-6 leading-relaxed"></p>
      <div class="flex justify-end gap-3">
        <button id="custom-alert-cancel-btn"
          class="rounded-full bg-zinc-800 text-zinc-300 font-bold px-6 h-10 hidden hover:text-white hover:bg-zinc-700 transition-all text-sm">Cancelar</button>
        <button id="custom-alert-ok-btn"
          class="rounded-full bg-indigo-600 text-white font-bold px-8 h-10 shadow-lg shadow-indigo-600/20 hover:bg-indigo-500 hover:shadow-indigo-600/40 transition-all text-sm">OK</button>
      </div>
    </div>
  </div>

  <!-- Detail Overlay Modal (Lista de Presen√ßa/Aus√™ncia) -->
  <div id="detail-overlay" class="fixed inset-0 bg-zinc-950/95 backdrop-blur-xl hidden z-[100] flex flex-col transition-all duration-300 opacity-0 pointer-events-none transform scale-95">
     <!-- Header -->
     <div class="p-6 md:p-8 flex justify-between items-center border-b border-white/5 bg-zinc-900/30">
       <div>
          <h2 id="detail-overlay-title" class="text-2xl md:text-3xl font-bold text-white tracking-tight">Detalhes</h2>
          <p id="detail-overlay-subtitle" class="text-zinc-400 mt-1 text-sm md:text-base">Lista de alunos</p>
       </div>
       <button id="close-detail-overlay" class="p-2.5 rounded-full bg-white/5 hover:bg-white/10 text-zinc-400 hover:text-white transition-all ring-1 ring-white/5 hover:ring-white/10">
         <svg xmlns="http://www.w3.org/2000/svg" class="size-6 md:size-7" fill="none" viewBox="0 0 24 24" stroke="currentColor">
           <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
         </svg>
       </button>
     </div>
     
     <!-- Content -->
     <div class="flex-1 overflow-y-auto p-6 md:p-8">
       <div class="max-w-6xl mx-auto">
         <!-- Search within modal -->
         <div class="mb-8 relative max-w-xl mx-auto md:mx-0">
            <svg xmlns="http://www.w3.org/2000/svg" class="absolute left-4 top-1/2 -translate-y-1/2 text-zinc-500 w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
            <input type="text" id="detail-search" placeholder="Buscar aluno nesta lista..." class="w-full bg-zinc-900/50 border border-white/10 rounded-2xl pl-12 pr-4 py-3.5 text-zinc-100 placeholder-zinc-600 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/20 transition-all">
         </div>
         
         <!-- Loading State -->
         <div id="detail-loading" class="hidden flex justify-center py-20">
            <svg class="animate-spin size-10 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
         </div>

         <!-- List Grid -->
         <div id="detail-list-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
             <!-- Items will be injected here via JS -->
         </div>
         
         <!-- Empty State -->
         <div id="detail-empty-state" class="hidden flex flex-col items-center justify-center py-20 text-zinc-500">
            <div class="p-6 rounded-full bg-zinc-900/50 mb-4 ring-1 ring-white/5">
                <svg xmlns="http://www.w3.org/2000/svg" class="size-8 opacity-40" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
                </svg>
            </div>
            <p class="text-lg font-medium">Nenhum aluno encontrado.</p>
            <p class="text-sm">Tente ajustar o termo de busca.</p>
         </div>
       </div>
     </div>
  </div>

  <!-- Modal de Edi√ß√£o de Atividade -->
  <div id="edit-activity-modal"
    class="fixed inset-0 z-50 flex items-center justify-center bg-zinc-950/80 backdrop-blur-sm hidden p-4">
    <div
      class="bg-zinc-900 border border-white/5 rounded-2xl shadow-2xl shadow-black/50 w-full max-w-md p-6 md:p-8 relative">
      <button id="close-edit-activity-modal"
        class="absolute top-4 right-4 text-zinc-400 hover:text-white text-2xl transition-colors">&times;</button>
      <h2 class="text-zinc-100 text-2xl font-bold mb-6 tracking-tight">Editar Atividade</h2>
      <form id="form-edit-activity">
        <input type="hidden" id="edit-activity-original-timestamp">
        <input type="hidden" id="edit-activity-user-id">

        <label class="flex flex-col mb-4">
          <span class="text-zinc-400 text-sm font-medium pb-2">Usu√°rio</span>
          <input id="edit-activity-user-name" type="text" readonly
            class="form-input rounded-xl bg-zinc-950/30 border border-white/5 text-zinc-500 h-11 px-4 cursor-not-allowed">
        </label>

        <label class="flex flex-col mb-4">
          <span class="text-zinc-400 text-sm font-medium pb-2">Tipo</span>
          <select id="edit-activity-type"
            class="form-input rounded-xl bg-zinc-950/50 border border-white/5 text-zinc-100 h-11 px-4 focus:bg-zinc-900 focus:border-indigo-500/50 focus:ring-2 focus:ring-indigo-500/20 outline-none transition-all cursor-pointer">
            <option value="Entrada">Entrada</option>
            <option value="SAIDA">SAIDA</option>
          </select>
        </label>

        <label class="flex flex-col mb-4">
          <span class="text-zinc-400 text-sm font-medium pb-2">Data e Hora</span>
          <input id="edit-activity-timestamp" type="datetime-local"
            class="form-input rounded-xl bg-zinc-950/50 border border-white/5 text-zinc-100 h-11 px-4 focus:bg-zinc-900 focus:border-indigo-500/50 focus:ring-2 focus:ring-indigo-500/20 outline-none transition-all"
            style="color-scheme: dark;">
        </label>

        <div class="flex justify-end items-center mt-6">
          <button type="submit"
            class="rounded-full bg-indigo-600 text-white font-bold px-8 h-10 shadow-lg shadow-indigo-600/20 hover:bg-indigo-500 hover:shadow-indigo-600/40 transition-all text-sm">Salvar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal de Frequ√™ncia Manual -->
  <div id="manual-frequency-modal"
    class="fixed inset-0 z-50 flex items-center justify-center bg-zinc-950/80 backdrop-blur-sm hidden p-4">
    <div
      class="bg-zinc-900 border border-white/5 rounded-2xl shadow-2xl shadow-black/50 w-full max-w-md p-6 md:p-8 relative">
      <button id="close-manual-frequency-modal"
        class="absolute top-4 right-4 text-zinc-400 hover:text-white text-2xl transition-colors">&times;</button>
      <h2 class="text-zinc-100 text-2xl font-bold mb-6 tracking-tight">Adicionar Frequ√™ncia Manual</h2>
      <form id="form-manual-frequency">
        <label class="flex flex-col mb-4 relative">
          <span class="text-zinc-400 text-sm font-medium pb-2">Aluno</span>
          <input type="text" id="manual-frequency-user-search" placeholder="Digite para buscar o aluno..."
            autocomplete="off"
            class="form-input rounded-xl bg-zinc-950/50 border border-white/5 text-zinc-100 h-11 px-4 placeholder:text-zinc-600 focus:bg-zinc-900 focus:border-indigo-500/50 focus:ring-2 focus:ring-indigo-500/20 outline-none transition-all">
          <input type="hidden" id="manual-frequency-user-id">
          <div id="manual-frequency-user-results"
            class="absolute top-full left-0 right-0 bg-zinc-900 border border-white/5 rounded-b-xl max-h-48 overflow-y-auto z-10 hidden shadow-xl shadow-black/50">
            <!-- Resultados da busca ser√£o inseridos aqui -->
          </div>
        </label>

        <label class="flex flex-col mb-4">
          <span class="text-zinc-400 text-sm font-medium pb-2">Data e Hora</span>
          <input id="manual-frequency-timestamp" type="datetime-local" required
            class="form-input rounded-xl bg-zinc-950/50 border border-white/5 text-zinc-100 h-11 px-4 focus:bg-zinc-900 focus:border-indigo-500/50 focus:ring-2 focus:ring-indigo-500/20 outline-none transition-all"
            style="color-scheme: dark;">
        </label>

        <label class="flex flex-col mb-4">
          <span class="text-zinc-400 text-sm font-medium pb-2">Tipo</span>
          <select id="manual-frequency-type"
            class="form-input rounded-xl bg-zinc-950/50 border border-white/5 text-zinc-100 h-11 px-4 focus:bg-zinc-900 focus:border-indigo-500/50 focus:ring-2 focus:ring-indigo-500/20 outline-none transition-all cursor-pointer">
            <option value="Entrada">Entrada</option>
            <option value="Sa√≠da">Sa√≠da</option>
          </select>
        </label>

        <div class="flex justify-end items-center mt-8 gap-4 pt-4 border-t border-white/5">
          <button type="button" id="cancel-manual-frequency"
            class="rounded-full bg-zinc-800 text-zinc-300 font-bold px-6 h-10 hover:bg-zinc-700 hover:text-white transition-all text-sm">Cancelar</button>
          <button type="submit"
            class="rounded-full bg-indigo-600 text-white font-bold px-8 h-10 shadow-lg shadow-indigo-600/20 hover:bg-indigo-500 hover:shadow-indigo-600/40 transition-all text-sm">Salvar</button>
        </div>
      </form>
    </div>
  </div>
  <!-- AI Assistant Chat Widget -->
  <div id="ai-widget-container" class="fixed bottom-6 right-6 z-50 flex flex-col items-end gap-4">
    <!-- Chat Window -->
    <div id="ai-chat-window"
      class="hidden w-80 sm:w-96 h-[500px] bg-zinc-900 border border-white/10 rounded-2xl shadow-2xl flex flex-col overflow-hidden transition-all origin-bottom-right animate-in fade-in slide-in-from-bottom-4 duration-300">
      <!-- Header -->
      <div class="bg-indigo-600 p-4 flex justify-between items-center shadow-md z-10">
        <h3 class="font-bold text-white flex items-center gap-2 select-none">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24"
            stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
          </svg>
          Veritas AI
          <span class="text-xs bg-white/20 px-2 py-0.5 rounded-full text-indigo-100 font-medium">Offline</span>
        </h3>
        <button id="close-ai-chat"
          class="text-white/70 hover:text-white transition-colors p-1 rounded-lg hover:bg-white/10">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>

      <!-- Messages Area -->
      <div id="ai-messages" class="flex-1 overflow-y-auto p-4 space-y-4 bg-zinc-950/50 scroll-smooth custom-scrollbar">
        <!-- Welcome Message -->
        <div class="flex flex-col gap-1 items-start max-w-[85%]">
          <div
            class="bg-zinc-800 border border-white/5 text-zinc-200 px-4 py-3 rounded-2xl rounded-tl-sm text-sm shadow-sm">
            <p>Ol√°! Sou a assistente inteligente do Veritas. ü§ñ</p>
            <p class="mt-2 text-zinc-400 text-xs">Posso responder sobre alunos, faltas, turmas e respons√°veis. Tudo
              offline!</p>
          </div>
          <span class="text-[10px] text-zinc-600 ml-1">Agora</span>
        </div>
      </div>

      <!-- Input Area -->
      <div class="p-3 bg-zinc-900 border-t border-white/5 flex gap-2">
        <input id="ai-input" type="text" placeholder="Pergunte algo..."
          class="flex-1 bg-zinc-950/50 border border-white/10 rounded-xl px-4 py-2.5 text-sm text-white placeholder-zinc-500 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/20 transition-all">
        <button id="ai-send-btn"
          class="bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl p-2.5 transition-colors shadow-lg shadow-indigo-600/20 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 rotate-90" fill="none" viewBox="0 0 24 24"
            stroke="currentColor" stroke-width="2.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 19V5M5 12l7-7 7 7" />
          </svg>
        </button>
      </div>
    </div>

    <!-- Toggle Button -->
    <button id="toggle-ai-chat"
      class="h-14 w-14 rounded-full bg-indigo-600 hover:bg-indigo-500 shadow-xl shadow-indigo-600/30 text-white flex items-center justify-center transition-all hover:scale-110 active:scale-90 group z-50 ring-2 ring-white/10 hover:ring-indigo-400/50">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7 transition-transform group-hover:rotate-12" fill="none"
        viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
      </svg>
    </button>
  </div>
  <script src="/socket.io/socket.io.js"></script>
  <script src="dropdown.js"></script>
  <script src="api-web.js"></script>
  <script src="script.js"></script>
  <script src="settings.js"></script>
</body>

</html>